import numpy as np


def ReadIne(filename):
    """
    Read the division trails from filename to a list
    """
    fileobj = open(filename, "r")
    ine = []
    for i in fileobj:
        ine.append(list(map(int, (i.strip()).split())))
    fileobj.close()
    return ine


sbox_ineq3_my = [[1, 1, 1, -1, -1, -1, 0],
                 [-1, -1, -2, 1, 0, 1, 2],
                 [-1, -1, 0, 1, 2, 1, 0],
                 [-1, 0, -1, 0, 1, -1, 2],
                 [0, -1, -1, -1, 1, 0, 2],
                 [-1, 0, 0, -1, -1, 1, 2],
                 [0, -1, 0, 1, -1, -1, 2],
                 [0, -1, -1, 1, 1, 2, 0]]
sbox_ineq3_other = (
    (2, 2, 4, 1, -5, -1, -2), \
    (2, -1, -2, -1, 0, 1, 1), \
    (0, -1, 0, -1, 2, 1, 1), \
    (1, 1, 1, 2, 0, -2, -1), \
    (2, -2, -1, -1, 1, 1, 0), \
    (0, 0, -1, -1, 1, 1, 2), \
    (2, -1, -1, 0, -1, 0, 1), \
    (1, 0, 1, -1, 0, 1, -1))

sbox_ineq4_my = [[1, 1, 1, 1, -1, -1, -1, -1, 0],
                 [-2, -1, -1, -2, 1, 1, 0, 1, 3],
                 [3, 0, 0, 0, -1, -1, -1, -1, 1],
                 [-1, 0, -1, -1, 1, 2, 1, 2, 0],
                 [0, 0, 0, 3, -1, -2, -1, -1, 2],
                 [1, 0, 1, 0, -2, -1, 1, -2, 2],
                 [1, 0, -1, 0, 0, -1, -2, 1, 2],
                 [-1, 0, -1, 0, 1, 0, 1, -1, 2],
                 [0, 0, 1, 0, 1, 0, -1, -1, 1],
                 [-1, -1, 0, -1, 0, 1, 1, 1, 1],
                 [-1, 1, 0, -1, 1, -1, 1, 0, 2],
                 [0, 0, 1, 2, -1, -1, -1, -1, 1],
                 [0, 0, -1, -1, 0, 1, -1, 0, 2],
                 [0, -1, 0, 0, 1, 1, 1, 1, 0]]

sbox_ineq4_other = (
    (-2, -1, -1, -2, 1, 1, 0, 1, 3), \
    (2, 1, 1, 3, -2, 0, 0, -1, 0), \
    (2, 1, 0, 0, -1, -1, -2, 0, 2), \
    (-1, 0, -1, -1, 1, 2, 1, 2, 0), \
    (-2, -1, 1, -2, 1, 1, 2, 3, 1), \
    (-1, 1, -1, 0, 1, 1, 0, 1, 0), \
    (0, 1, 1, 0, 0, 0, -1, -1, 1), \
    (-2, -2, -3, -1, 2, -1, 1, -2, 8), \
    (0, 0, -1, 1, -1, -1, 0, 1, 2), \
    (1, -1, -1, 1, 2, 2, 0, 1, 0), \
    (1, 0, 1, 2, -2, 0, 0, -1, 1), \
    (0, 0, -1, -1, 0, 0, -1, 1, 2), \
    (1, 1, 0, 1, 0, -1, 0, 0, 0), \
    (0, 1, 1, 1, 0, 0, 0, -1, 0), \
    (0, -1, 1, 0, -1, 1, 1, 0, 1), \
    (0, 0, 1, 0, -1, -1, -1, -1, 3), \
    (-2, -1, -3, -2, 1, -1, 2, -1, 7), \
    (-1, -1, 1, 0, 1, -1, 0, 1, 2), \
    (1, -1, 0, -1, 1, -1, 1, -1, 3), \
    (1, 1, -1, 0, -1, 1, 0, 0, 1), \
    (0, 0, 1, -1, 1, 1, -1, -1, 2))

martrix_my = np.array(sbox_ineq4_my)
file_name = 'sbox/pyjamask_sbox_4_DivisionTrails.txt'
division_trails = ReadIne(file_name)
for dt in division_trails:
    # s = [1]
    # dt.reverse()
    # s += dt[3:]
    # s += dt[:3]
    # print(martrix_my.dot(s))

    s = dt + [1]


    # dt.reverse()
    # s = dt[4:]
    # s += dt[:4]
    # s += [1]
    print(martrix_my.dot(s))
    # print(martrix_my.dot(s))
